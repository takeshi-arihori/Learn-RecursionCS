## オブジェクト指向設計

オブジェクト指向プログラミング（OOP）は、プログラム全体をオブジェクト（状態と振る舞いを持つ要素）として設計する手法です。これは、たとえば、ゲームのキャラクターや自動車などの具体的な「もの」をプログラムの中に作り出し、それらが相互作用することで全体としてのプログラムを構築するというイメージ。
一方、手続き型プログラミングは、一連の手順（手続き）に従ってデータを操作するプログラミングの形式です。これは、たとえば、レシピに従って料理を作るようなイメージで、一つ一つの手続きがデータ（材料）を変換していきます。
オブジェクトの相互作用によってプログラム全体が動くという考え方は、基本的に OOP の特徴です。

### 契約

そのクラスがどのように動作すべきか、または具体的にはどのようにやりとりすることができるかを定義する一連のルールやプロトコルを指します。

## 関連と継承

### 関係の種類

- 関連（association）
- 集約（aggregation）
- コンポジション（composition）
- 継承（inheritance）

関連は、二つの異なるクラス間の二項関係を指す。
双方向性 -> 二つのクラスが互いにアクセス権を持つこと。お互い public 変数とメソッドにアクセスできる。
単方向性 -> 一つのクラスのみが他方のクラスへアクセス権を有している関係。

### 多重度

多重度とは、あるオブジェクトが関わる他のオブジェクトの数を示すもの。

### 集約とコンポジション

集約 -> あるクラス A がその状態の一部としてクラス B を含む形の関連を示します。
コンポジション -> 集約の特殊な形態で、ここでは集約されるオブジェクトが集約するオブジェクトに対して依存性を持ちます。コンポジションでは、所有者が完全な支配権を持つため、集約先のオブジェクトはそれ自体で存在することはできません。

### 依存関係

あるクラス A が何らかの形でクラス B に依存していて、クラス B の状態や振る舞いの変更がクラス A に影響を及ぼす可能性がある状況を指します。関連は依存関係の一種で、より強い形の依存関係。

関係が弱い: 依存 <- 関連 <- 集約 <- コンポジション <- 継承: 関係が強い

### 依存性注入(DI)

関数が必要とするクラスのオブジェクトを直接生成するのではなく、そのオブジェクトを外部から渡すことにより、依存関係を明示的にする方法。
この方法を使用すると、外部のユーザーはクラスが何に依存しているかを明確に理解することはできませんが、開発者はそのメソッドがどのオブジェクトに依存しているかを明確に知ることができます。これは関数型プログラミングの考え方に似ており、メソッドがその入力に明示的に依存する形となります。これにより、コードの理解性とメンテナンス性が向上します。

### 制御の反転(IoC)

プログラムの制御フローが従来の方法とは逆の方向に制御されるという概念。
従来の手法では、アプリケーションの制御フローは主にアプリケーション自体が担っていました。つまり、アプリケーションが他のコンポーネントやクラスを直接制御し、その実行順序や依存関係を管理していました。
一方、制御の反転では、アプリケーションは自らの制御フローをフレームワークのような他の外部エンティティに委任します。具体的には、アプリケーションは外部の制御コンテキストやフレームワークによって制御され、必要なタスクや処理の実行順序が外部から与えられます。これにより、アプリケーションは個々のコンポーネントやクラスに焦点を当てて開発することができます。

### 継承

あるクラスが別のクラスの既存の定義を引用し、それを基に自己の定義を行う、クラス間の関係性を指します。
継承を用いるとデータ構造の一般化が可能となり、主に is-a 関係を満たす際に用いられます。

### ポリモーフィズム

多くの形（poly は多く、morph は形を意味します）を取ることができます。
サブクラスがスーパークラスのすべてのメソッドと変数を受け継ぐことを保証し、これがプログラムのコンパイラによってチェックされるため、プログラムが実行される前にサブクラスがどのような機能を持つかを事前に確認することができます。

### キャスティング

特定のクラスのインスタンスを作成しながら、より一般的なスーパークラスに対して変数を割り当てることができます。このような行為はオブジェクトのキャスティング（casting）と呼ばれます。また、オブジェクトが特定のクラスのインスタンスであるかを確認するために、「instance of」というキーワードを使用することもあります。

### 抽象クラス

一部または全てのメソッドが未実装のクラスのこと。
UML においては、抽象クラスはイタリック体でクラス名を表示。

### 具象クラス

具体的な実装を持つクラスで、全てのメソッドが具体的な振る舞いを定義。

### オブジェクト指向プログラミングにおける抽象クラスの使用の一連の基本原則

- Rule 1
  抽象クラスは、Java のようなプログラミング言語における特別なタイプのクラスです。この不完全なメソッドは抽象メソッドと呼ばれ、クラスの中で abstract キーワードが使用される必要があります。

- Rule 2
  抽象クラスから直接オブジェクトを作成することはできません。抽象クラスのメソッドを使うには、抽象クラスを継承した別のクラスを作る必要があります。この新しいクラスはしばしば具象クラスと呼ばれます。具象クラスには、抽象クラスの抽象メソッドに足りないコードを含める必要があります。

- Rule 3
  抽象クラスでは、状態を定義しデフォルト値を割り当てることができます。さらに、状態を初期化するコンストラクタも定義できます。このコンストラクタは、サブクラスから呼び出されることが一般的です。サブクラスがこれらの状態にアクセスできるように、状態を protected として設定することを推奨します。

- Rule 4
  特定の言語では、抽象メソッドを持たない抽象クラスを定義することが許可されていることがあります。これによって、他のプログラマに、このクラスは親クラスであることを示すことができます。言い換えれば、サブクラス化することを強制する抽象メソッドがなくても、抽象クラスとして宣言されているという事実は、使用する前にサブクラス化されるべきであるというシグナルです。

こうすることで、コード内の特定のクラスが常に基底クラスとして使用され、オブジェクトを直接作成するために使用されないようにすることができます。これは良いコーディング設計の一部であり、コードの構造と構成を維持するのに役立ちます。

- Rule 5
  抽象クラスを継承した具象クラスで、すべての抽象メソッドのコードを実装しなかった場合、そのクラスも抽象クラスとなり、オブジェクトを直接作成するために使用することはできません。

- Rule 6
  具象クラスを継承したサブクラスを作成し、その内部で抽象メソッドを定義するか、親クラスのメソッドを抽象メソッドとして上書きすることで、サブクラスを抽象クラスにすることができます。

※ 継承のルールは「is-a」の関係を保持する必要がある。

## インターフェース

インターフェース（interface）とは、オブジェクトが実装しなければならない一連の振る舞いを定義したものです。インターフェースには抽象メソッドのみが含まれ、それらのメソッドはインターフェースを実装するクラスで使用されます。
コンポジションは通常、has-a の関係（人は BMI と名前を持つ）を持ち、継承は is-a の関係（キツネは哺乳類で、哺乳類は動物である）を持ちますが、インターフェースは契約ベースの関係（ヘリコプターと鷲は Fly を実装するため、飛ばなければならない）を持ちます。
