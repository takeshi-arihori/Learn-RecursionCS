# Least Recently Used Cache

LRU キャッシュは、最近使用されていないデータを優先的に削除することでメモリの効率を高めるキャッシュアルゴリズムです。高度なシステム設計において、メモリとディスクストレージの間でデータアクセスの速度差を埋めるために使われます。

## メモリとストレージの基本

- メモリ (RAM): 高速でアクセスできますが、容量が限られており、コストが高く、電源を切るとデータが消えます（揮発性）。
  小さい: たくさんのデータは入らない。
  高い: お金がかかる。
  消える: 電源を切るとデータがなくなる。
  速い: データをすぐに使える。

- ディスクストレージ (SSD): 大容量でコストが低く、データの永続性がありますが、データの読み書きに時間がかかる。
  大きい: たくさんのデータが入る。
  安い: お金があまりかからない。
  消えない: 電源を切ってもデータが残る。
  遅い: データを使うのに時間がかかる。

### 速さの違い

- メモリ: データを使うのにとても速い。例えば、50 ナノ秒（とても短い時間）。
- SSD: メモリより遅い。例えば、50 マイクロ秒（メモリの 1000 倍の時間）。

### キャッシュの必要性

多くのアプリケーションでのパフォーマンス向上には、メモリキャッシュが重要です。しかし、メモリ容量が限られているため、効率的なアルゴリズムでどのデータを保持し、どのデータを削除するかを決定する必要があります。

### メモリキャッシュについて

- L1 キャッシュ: 一番速い。メモリより数百倍速い。
- L2 キャッシュ: L1 キャッシュより遅いけど、メモリより数十倍速い。

アプリが速く動くためには、メモリキャッシュがとても大事です。でも、メモリには入れられるデータの量に限りがあります。だから、全部のデータをメモリに入れるのは無理です。この問題を解決するために、賢い方法（アルゴリズム）を使います。

### メモリキャッシュの仕組み

- 1. メモリキャッシュの役割:
     メモリにデータをキャッシュすると、CPU（コンピュータの頭脳）はストレージ（データを保存する場所）からデータを取り出すよりも早く、メモリ上のデータにアクセスできます。

- 2. キャッシュの容量設定:

まず、キャッシュに使うメモリの量を決めます。

- 3. キャッシュが満杯になったら:

キャッシュがいっぱいになったら、新しいデータを入れるために、古いデータをどれか削除しなければなりません。

メモリキャッシュを使うと、アプリが速く動くようになります。でも、メモリには限りがあるので、賢い方法を使って、どのデータを残してどのデータを消すかを決める必要があります。

### まとめ

- メモリは速いけど小さくて高い。電源を切るとデータが消える。
- ストレージは大きくて安い。電源を切ってもデータが残るけど、遅い。
- キャッシュメモリはもっと速いけど、さらに小さい。
- メモリキャッシュを使うと、アプリが速く動くようになります。でも、メモリには限りがあるので、賢い方法を使って、どのデータを残してどのデータを消すかを決める必要があります。

## LRU キャッシュ

LRU キャッシュは、コンピュータがデータを効率よく管理するための仕組みの一つです。LRU は「Least Recently Used（最近使われていない）」の略です。

- 1. LRUCache(int capacity):

これは新しい LRU キャッシュを作るためのものです。capacity はキャッシュが覚えておけるデータの数です。

- 2. get(key):

key という名前のデータを取り出します。もしそのデータがなければ null を返します。データがあれば、そのデータが最近使われたことを記録します。

- 3. put(key, data):

key と data をキャッシュに追加します。もし同じ key がすでにあれば、そのデータを新しい data で上書きします。キャッシュがいっぱいなら、一番古いデータを消して新しいデータを入れます。

- 順番を覚える:

データが使われた順番を覚えておく必要があります。これをするために、データをリスト（ノードリスト）に並べます。
リストの先頭には一番古いデータ、末尾には一番新しいデータが来るようにします。

- データの移動:

データが使われるたびに、そのデータをリストの末尾に移動させます。これで、リストの先頭には常に一番古いデータが、末尾には一番新しいデータが来るようになります。

## 双方向リスト

- 双方向リスト:

双方向リストは、前後に動けるリストです。これを使うと、データを簡単に追加したり削除したりできます。

- 配列と組み合わせる:

配列を使うと、データをすぐに見つけることができます。配列のインデックスが key になり、その場所にデータが入ります。もしその場所が null なら、そのデータは存在しないことを意味します。

- 1. 配列の大きさが固定

配列というのは、データを順番に並べて保存する箱のようなものです。この箱の大きさは最初に決めたら変えられません。例えば、5 個のデータを入れる箱を作ったら、6 個目のデータは入れられないということです。

- 2. メモリが必要

このデータ構造は、配列と双方向リストという 2 つの箱を同時に使います。だから、それぞれの箱を置くためのスペース（メモリ）が必要です。つまり、2 つの箱を置くために、たくさんのスペースが必要になるということです。

- 3. 容量が変更できない

一度作った箱の大きさは変えられません。もし箱の大きさを変えたいなら、全部のデータを新しい箱に移さないといけません。これには時間がかかります。

- 追加のポイント

配列の大きさは固定ですが、双方向リストの大きさは変わります。双方向リストは、その時に保存しているデータの数によって大きさが変わります。

LRU キャッシュという仕組みを作るときに、キー（データを探すための目印）を使います。キーは 0 から決まった数までの数字にしたり、特別な計算方法（ハッシュ関数）を使って決めたりできます。

### まとめ

- LRU キャッシュは、最近使われたデータを覚えておいて、古いデータを消す仕組みです。これを使うと、データの読み書きがとても速くなります。双方向リストと配列を使うことで、データの管理が簡単になります。
- 配列の大きさは変えられない。
- 2 つのデータ構造を使うためにたくさんのメモリが必要。
- 一度作ったデータ構造の大きさは変えられない。
